<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>

<main id="mainContainer" class="row">
    <container class="col-2">
        <form id="weather-form">
            <label for="locationInput"><strong>Location</strong></label>
            <input type="text" id="locationInput" placeholder="(e.g. Las Vegas)"><br>
        <!-- This button will trigger our AJAX call -->
            <input id="searchButton" type="submit" value="Search"></input>
        </form>
    </container>

    <container class="col-10">
    <div class="row">
    <div class="col-12">
    <ul>
    <header id="cityNameData"></header>
    <li><div id="temperature"></div></li>
    <li><div id="humidity"></div></li>
    <li><div id="wind-speed"></div></li>
    <li><div id="uvIndex"></div></li>
    </ul>
    <!-- <button id="searchButton">Search</button> -->
    </div>

    <div id="UV-index-results-here" class="row">
    </div>
    </container>
</main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

    
        $("#searchButton").on("click", function(event) {

        // event.preventDefault() can be used to prevent an event's default behavior.
        // Here, it prevents the submit button from trying to submit a form when clicked
        event.preventDefault();

        // $(document).ready(function () {
            var searchBtn = $("#searchButton");

            // searchBtn.on("click", function() {
            var cityName = $("#locationInput").val().trim();
            console.log(cityName);
            var queryURL = "https://api.openweathermap.org/data/2.5/weather?q=" + cityName + "&appid=1b5e9096e8f25e04ccd2e1d65aa7ae08";
            // var fiveDayForecast = "http://api.openweathermap.org/data/2.5/forecast/daily?q=" + cityName + "&appid=1b5e9096e8f25e04ccd2e1d65aa7ae08";


        $.ajax({
            url: queryURL,
            method: "GET"
        }).then(function(response) {

        console.log(response);

            var lat = response.coord.lat
            console.log(lat);
            var lon = response.coord.lon
            console.log(lon);

            var ForecastIndexQueryURL = "https://api.openweathermap.org/data/2.5/onecall?lat=" + lat + "&lon=" + lon + "&exclude=minutely,hourly" + "&units=imperial" + "&appid=1b5e9096e8f25e04ccd2e1d65aa7ae08";

        $.ajax({
            url: ForecastIndexQueryURL,
            method: "GET"
        }).then(function(res) {
            console.log(res);

            $("#UV-index-results-here").empty();
            $("#cityNameData").html("<h1>" + cityName + "</h1>");
            $("#temperature").text("Temperature: " + res.current.temp);
            $("#humidity").text("Humidity: " + res.current.humidity);
            $("#wind-speed").text("Wind Speed: " + res.current.weather.wind_speed);
            $("#uvIndex").text("Wind Speed: " + res.current.uvi);

            console.log(res);
            var results = res.daily;
            // Looping through each result item
            for (var i = 0; i < 5; i++) {

                // Creating and storing a div tag
                var forecastDiv = $("<div>");
                forecastDiv.addClass("col-md")

                // Creating a paragraph tag with the result item's rating
                var dailyTemp = $("<p>").text("Temperature: " + results[i].temp.day);
                var dailyHumidity = $("<p>").text("Humidity: " + results[i].humidity);
                // Appending the paragraph and image tag to the animalDiv
                forecastDiv.append(dailyTemp);
                forecastDiv.append(dailyHumidity)
                $("#UV-index-results-here").prepend(forecastDiv);
            }


        });

    });

    // $.ajax({
    //       url: fiveDayForecast,
    //       method: "GET"
    //     }).then(function(resp) {


    
        // });

});



</script>

    
</body>
</div>
</html>